{% extends 'base.html' %}

{% block content %}
    <h1>Корисні матеріали</h1>

    {% if materials %}
        <ul class="list-group">
            {% for material in materials %}
                <li class="list-group-item">
                    <strong>{{ material.title }}</strong><br>
                    Опис: {{ material.description }}<br>
                    {% if material.content_type == 'file' and material.file %}
                        <a href="{{ material.file.url }}" class="btn btn-sm btn-info" download>Завантажити файл</a>
                    {% elif material.content_type == 'image' and material.image %}
                        <img src="{{ material.image.url }}" alt="{{ material.title }}" style="max-width: 100%; height: auto;">
                    {% elif material.content_type == 'youtube' %}
                        {% with youtube_id=material.get_youtube_id %}
                            {% if youtube_id %}
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/{{ youtube_id }}" title="{{ material.title }}" frameborder="0" allowfullscreen></iframe>
                            {% else %}
                                <p>Невалідне YouTube-посилання.</p>
                            {% endif %}
                        {% endwith %}
                    {% endif %}
                    <br>
                    Створено: {{ material.created_at }} автором {{ material.creator.username }}<br>
                    {% if user.is_authenticated and user.profile.role in 'admin,moderator' %}
                        <a href="{% url 'materials:material-update' material.pk %}" class="btn btn-sm btn-warning">Редагувати</a>
                        <a href="{% url 'materials:material-delete' material.pk %}" class="btn btn-sm btn-danger">Видалити</a>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>Матеріалів немає.</p>
    {% endif %}

    {% if user.is_authenticated and user.profile.role in 'admin,moderator' %}
        <a href="{% url 'materials:material-create' %}" class="btn btn-primary mt-3">Додати матеріал</a>
    {% endif %}
{% endblock %}